var postData = [
  {
    "title": "Open Call 1/A",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "CityxChange",
    "owner": "Citizen Group", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "Innovation Playground",
    "keywords": ["SDG11", "Sustainable Cities and Communities"],
    "activitytag": "Citizen Sensing",
    "tags": [],
    "theme": "Air Quality",
    "technology": "Smart Sensors",
    "opendata": true,
    "dataformat": "PDF",
    "licence": "CC 3.0 Attrib.",
    "projecturl": "https://google.com",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  },
  {
    "title": "Positive Energy Champions",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "CityxChange",
    "owner": "LCCC", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "Limerick Metropolitan Area",
    "keywords": ["SDG7", "Affordable and Clean Energy"],
    "activitytag": "Energy Monitoring",
    "tags": [],
    "theme": "Low-Carbon Transport",
    "technology": "Solar Cells",
    "opendata": false,
    "dataformat": "CSV",
    "licence": "",
    "projecturl": "",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  },
  {
    "title": "DST",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "LCCC",
    "owner": "LCCC", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "Decarbonisation Zone",
    "keywords": ["SDG13", "Climate Action"],
    "activitytag": "Envisioning",
    "tags": [],
    "theme": "Energy Community",
    "technology": "Digital participation tool",
    "opendata": false,
    "dataformat": "Other",
    "licence": "Share-Alike",
    "projecturl": "",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  },
  {
    "title": "Community Mapping",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "LCCC",
    "owner": "Citizen Group", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "Limerick City and County",
    "keywords": ["SDG7", "Affordable and Clean Energy"],
    "activitytag": "Learning",
    "tags": ["GIS", "Mapping", "Energy Surveys"],
    "theme": "Energy Efficiency/Retrofit",
    "technology": "",
    "opendata": false,
    "dataformat": "",
    "licence": "",
    "projecturl": "",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  },
  {
    "title": "Space for emerging self-organised activities",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "",
    "owner": "", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "Garryowen",
    "keywords": ["Decarbonisation"],
    "activitytag": "Prototyping",
    "tags": [],
    "theme": "Sustainable Financial Models",
    "technology": "",
    "opendata": false,
    "dataformat": "",
    "licence": "",
    "projecturl": "",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  },
  {
    "title": "City Model",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "Fab Lab Limerick",
    "owner": "Fab Lab Limerick", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "Garryowen",
    "keywords": ["SDG3", "Good Health and Wellbeing"],
    "activitytag": "Making",
    "tags": ["Architecture", "Building", "GIS", "Mapping", "3D", "3D Printing"],
    "theme": "Renewable Energy Systems",
    "technology": "Renewable Energy Systems",
    "opendata": false,
    "dataformat": "",
    "licence": "",
    "projecturl": "",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  },
  {
    "title": "Experimental Sandbox",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "Fab Lab Limerick",
    "owner": "L3", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "",
    "keywords": ["SDG9", "Industry Innovation and Infrastucture"],
    "activitytag": "Co-Creating",
    "tags": [],
    "theme": "Behaviour Change",
    "technology": "",
    "opendata": false,
    "dataformat": "",
    "licence": "",
    "projecturl": "",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  },
  {
    "title": "SmartLAB",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "SmartLAB",
    "owner": "", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "",
    "keywords": ["SDG11", "Sustainable Cities and Communities"],
    "activitytag": "Debating",
    "tags": [],
    "theme": "Clean Energy",
    "technology": "",
    "opendata": false,
    "dataformat": "",
    "licence": "",
    "projecturl": "",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  },
  {
    "title": "Decarbonising Together",
    "image": "https://www.limerick.ie/sites/default/files/styles/panel_image/public/media/images/2019-09/Positive%20City%20Exchange%20Limerick%20810x456_0.jpg?itok=cueX4dto",
    "sponsor": "Decarbonising Together",
    "owner": "", 
    "contact": "name",
    "collaboraotrs": "",
    "location": "",
    "keywords": ["SDG15", "Life on Land"],
    "activitytag": "Other",
    "tags": [],
    "theme": "Other",
    "technology": "",
    "opendata": false,
    "dataformat": "",
    "licence": "",
    "projecturl": "",
    "description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pellentesque quam non felis consequat commodo. Suspendisse potenti. Vestibulum dui ipsum, gravida in urna vel, elementum viverra erat. In pharetra placerat mauris ut ultrices. Maecenas mattis mauris sed neque euismod, sed semper sem semper. Praesent semper facilisis nisl in ornare. Aenean massa ex, porta eu molestie id, viverra eu libero. Quisque vel finibus tellus. <br />Nam varius orci non bibendum ultrices. Proin congue tortor in neque rhoncus commodo. Duis at ligula nisi. Vestibulum in condimentum sapien, in mattis mauris. Maecenas vitae ante a nunc vulputate convallis. Donec maximus purus a dolor imperdiet, nec dignissim nibh efficitur. In egestas vel ipsum eget accumsan. Donec in odio vel tortor porta ultricies. Duis in ex venenatis, finibus elit et, efficitur odio. Nullam ut facilisis sapien. Vestibulum tortor dolor, tempor eu odio ac, lobortis tristique elit. Nulla porta nisi et nulla vestibulum, id aliquet turpis porttitor. Mauris vehicula ipsum sed velit blandit pellentesque. Nulla facilisi."
  }
];

function mysearch(data,search) {
  var obj = [], index=0;
  for(var i=0; i<data.length; i++) {
    for(key in data[i]){
       if(data[i][key].toString().toLowerCase().indexOf(search.toLowerCase())!=-1) {
              obj[index] = data[i];
              index++;
              break;
       }
    }
  }

  return obj;
}


function clear_data() {
 
  $('.project').remove();
}

function append_json(data) {
  //Set Up the template
  var s = $("#postTemplate")[0].innerHTML.trim();
  var holder = document.createElement('div');
  holder.innerHTML = s;
  var template = holder.childNodes;

  var project = document.getElementById('projects');
  data.forEach(function(object, index) {

    if(index%3 == 0) {
      $(".projects").append("<div class='row'>");
    }
    //Clone Template
    var newItem = $(template).clone();

    //Populate it
    $(newItem).find(".type").html(object.type);
    $(newItem).find(".year").html($(newItem).find(".year").html() + " " + object.year);
    $(newItem).find(".projecturl").attr("href", object.projecturl);
    var img = $(newItem).find(".image")
    $(img).attr("src", object.image).attr("alt", $(img).attr("alt") + object.title)
      .attr("title", $(img).attr("title") + object.title);
    $(newItem).find(".title").html(object.title);
    $(newItem).find(".owner").html(object.owner);
    $(newItem).find(".description").html(object.description);

    object.tags.forEach(function(tag, idx, array) {
      if (idx === array.length - 1){ 
        $(newItem).find(".tags").html($(newItem).find(".tags").html() + tag);
      } else {
        $(newItem).find(".tags").html($(newItem).find(".tags").html() + tag + ", ");
      }
    });

    //Append it
    $(".projects").children().last().append(newItem);

  });
}

$("document").ready(function() {

  // ATTACH KEY UP LISTENER TO SEARCH BOX
  document.getElementById("the-filter").addEventListener("keyup", function(){
    // GET THE SEARCH TERM
    var searchterm = this.value.toLowerCase();

    // FILTER BASED ON TERM
    clear_data();
    append_json( mysearch(postData,searchterm));
  });

  // SET UP THE MENU HANDLERS
  var menu_elements = document.getElementsByClassName("dropdown-item");

  var menuClick = function() {
    var search_criteria = this.innerHTML;
    // FILTER BASED ON TERM
    clear_data();
    append_json(mysearch(postData,search_criteria));
};

for (var i = 0; i < menu_elements.length; i++) {
    menu_elements[i].addEventListener('click', menuClick, false);
}

  append_json(postData);
});
